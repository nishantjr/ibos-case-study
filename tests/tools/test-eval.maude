load ../systems/ibos-preds.maude
load ../../rltool-lib.maude

mod TEST is
  pr UNIFIERS .                  --- metaMatch/safeMatch variants
  pr CONSTRAINED-TERMSET-MATCH . --- #match
  pr REACH-PROOF-GOALSET .       --- goalsByMatch, !goalsByMatch, #goalsByMatch
  pr META-PARSE .                --- stringToTerm (easier testing)
  pr REMOVE-IDS .
  pr RLTOOL .

  op ibos : -> Module [ctor memo] .
  eq ibos = removeIds(upModule('IBOS-PREDS,true),all) .

  op ibos_ : String -> Term .
  eq ibos S:String = stringToTerm(ibos,S:String) .
endm

set print conceal on .
print conceal fmod_is_sorts_.____endfm mod_is_sorts_._____endm .

red ibos .

set break on .
break select context-rew1 .
red context-rew-simp(ibos,
'true.Bool != 
'_and_[
  '_undef-or-equal_['&86:MaybeLabel,'&132:Label],
  '_~l_['&70:Label,'&132:Label],
  'allEqLabel?['&132:Label,'_;_['&87:LabelList,'&134:NeLabelList]],
  'currHandled1?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'&58:Message?],
  'fetchMsg2?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'&129:MessageList],
  'retMsg?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'_@_['&89:MessageList,'&129:MessageList]],
  'fetchMsg1?['&127:ConcWebProcId,'true.Bool,'&132:Label,'&131:MessageList,'_`,np_['&97:NetProcInfoSet,'pi['&96:ConcNetProcId,'&132:Label,'&132:Label]]]]
\/
'true.Bool !=
'_and_[
  '_undef-or-equal_['&86:MaybeLabel,'&132:Label],
  --- '_~l_['&70:Label,'&132:Label],
  'allEqLabel?['&132:Label,'_;_['&87:LabelList,'&134:NeLabelList,'&70:Label]],
  'currHandled1?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'&58:Message?],
  'fetchMsg2?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'&129:MessageList],
  'retMsg?['&127:ConcWebProcId,'&96:ConcNetProcId,'&132:Label,'_@_['&89:MessageList,'&129:MessageList]],
  'fetchMsg1?['&127:ConcWebProcId,'true.Bool,'&132:Label,'&131:MessageList,'_`,np_['&97:NetProcInfoSet,'pi['&96:ConcNetProcId,'&132:Label,'&132:Label]]]]
\/
'true.Bool != 'p['__[
  '<_|_>['&96:ConcNetProcId,'_`,_['&84:AttributeSet,'fromKernel['&85:MessageList],'in['&134:NeLabelList],'mem-in['&70:Label],'mem-out['&86:MaybeLabel],'out['&87:LabelList],'returnTo['&127:ConcWebProcId],'toKernel['&89:MessageList]]],
  '<_|_>['&127:ConcWebProcId,'_`,_['&128:AttributeSet,'URL['&132:Label],'fromKernel['&129:MessageList],'loading['true.Bool],'rendered['&133:Label],'toKernel['&131:MessageList]]]],
  '_`,wp_['&123:WebProcInfoSet,'pi['&127:ConcWebProcId,'&132:Label]],'_`,np_['&97:NetProcInfoSet,'pi['&96:ConcNetProcId,'&132:Label,'&132:Label]],'&58:Message?]
\/
'true.Bool ?= 'p['__[
  '<_|_>['&127:ConcWebProcId,'_`,_['&128:AttributeSet,'URL['&132:Label],'fromKernel['&129:MessageList],'loading['true.Bool],'rendered['&133:Label],'toKernel['&131:MessageList]]],
    '<_|_>['&96:ConcNetProcId,'_`,_['&84:AttributeSet,'fromKernel['&85:MessageList],'in['_;_['&134:NeLabelList,'&70:Label]],'mem-in['nolabel.MaybeLabel],'mem-out['&86:MaybeLabel],'out['&87:LabelList],'returnTo['&127:ConcWebProcId],'toKernel['&89:MessageList]]]],

      '_`,wp_['&123:WebProcInfoSet,'pi['&127:ConcWebProcId,'&132:Label]],'_`,np_['&97:NetProcInfoSet,'pi['&96:ConcNetProcId,'&132:Label,'&132:Label]],'&58:Message?]
) .

break select interreduce .
resume .
break select reduce .
resume .
